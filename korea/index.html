<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Paul Schrimpf">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>South Korea - CovidSEIR.jl</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-forest-light.min.css">
        <link href="../assets/Documenter.css" rel="stylesheet">
        <link href="../assets/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">CovidSEIR.jl</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Package Docs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">SEIR Model and Results <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../covid/" class="dropdown-item">Model</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Results</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../canada/" class="dropdown-item">Canada</a>
</li>
            
<li>
    <a href="../italy/" class="dropdown-item">Italy</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">South Korea</a>
</li>
            
<li>
    <a href="../china/" class="dropdown-item">China</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../italy/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../china/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/schrimpf/CovidSEIR.jl/edit/master/docs/korea.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#south-korea" class="nav-link">South Korea</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#estimates" class="nav-link">Estimates</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fit" class="nav-link">Fit</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#implications" class="nav-link">Implications</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></p>
<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike
4.0 International
License</a></p>
<pre><code class="julia">using CovidSEIR,  Plots, DataFrames, JLD2, StatsPlots
Plots.pyplot()
jmddir = normpath(joinpath(dirname(Base.find_package(&quot;CovidSEIR&quot;)),&quot;..&quot;,&quot;docs&quot;,&quot;jmd&quot;))
covdf = covidjhudata()
describe(covdf)
</code></pre>

<pre><code>11×8 DataFrame. Omitted printing of 2 columns
│ Row │ variable  │ mean      │ min         │ median    │ max        │ nuni
que │
│     │ Symbol    │ Union…    │ Any         │ Union…    │ Any        │ Unio
n…  │
├─────┼───────────┼───────────┼─────────────┼───────────┼────────────┼─────
────┤
│ 1   │ Date      │           │ 2020-01-22  │           │ 2020-03-29 │ 68  
    │
│ 2   │ confirmed │ 521.072   │ 0           │ 0.0       │ 140886     │     
    │
│ 3   │ Province  │           │ Alberta     │           │ Zhejiang   │ 79  
    │
│ 4   │ Country   │           │ Afghanistan │           │ Zimbabwe   │ 177 
    │
│ 5   │ Lat       │ 22.0528   │ -41.4545    │ 23.8298   │ 71.7069    │     
    │
│ 6   │ Long      │ 23.2675   │ -135.0      │ 20.9394   │ 178.065    │     
    │
│ 7   │ deaths    │ 20.5945   │ 0           │ 0.0       │ 10779      │     
    │
│ 8   │ recovered │ 168.91    │ 0           │ 0.0       │ 62570      │     
    │
│ 9   │ iso2c     │           │ AD          │           │ ZW         │ 171 
    │
│ 10  │ cpop      │ 2.2813e8  │ 33785.0     │ 2.49924e7 │ 1.39273e9  │     
    │
│ 11  │ ppop      │ 2.74801e7 │ 41078       │ 1.557e7   │ 111690000  │     
    │
</code></pre>
<h1 id="south-korea">South Korea<a class="headerlink" href="#south-korea" title="Permanent link">&para;</a></h1>
<pre><code class="julia">korea = CountryData(covdf, &quot;Korea, South&quot;)
</code></pre>

<pre><code>CountryData{Float64,Int64}(5.1635256e7, [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  
59, 60, 61, 62, 63, 64, 65, 66, 67, 68], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
, 0.0, 0.0, 0.0  …  94.0, 102.0, 111.0, 111.0, 120.0, 126.0, 131.0, 139.0, 
144.0, 152.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  1540.0
, 1540.0, 2909.0, 2909.0, 3507.0, 3730.0, 4144.0, 4528.0, 4811.0, 5033.0], 
[1.0, 1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 11.0  …  7018.0, 7157.0, 5941
.0, 5941.0, 5410.0, 5281.0, 4966.0, 4665.0, 4523.0, 4398.0])
</code></pre>
<pre><code class="julia">using Turing
mdl = countrymodel(korea)
cc = Turing.psample(mdl, NUTS(0.65), 2000, 4)
import JLD2
JLD2.@save &quot;$jmddir/korea_$(Dates.today()).jld2&quot; cc
</code></pre>

<pre><code class="julia">JLD2.@load &quot;$jmddir/korea_2020-03-29.jld2&quot; cc;
</code></pre>

<h2 id="estimates">Estimates<a class="headerlink" href="#estimates" title="Permanent link">&para;</a></h2>
<pre><code class="julia">plot(cc)
</code></pre>

<p><img alt="" src="../figures/korea_5_1.png" /></p>
<pre><code class="julia">describe(cc)
</code></pre>

<pre><code>2-element Array{MCMCChains.ChainDataFrame,1}

Summary Statistics
  parameters      mean      std  naive_se    mcse        ess   r_hat
  ──────────  ────────  ───────  ────────  ──────  ─────────  ──────
           a    0.7445   0.1648    0.0026  0.0030  2659.4445  1.0001
         pE0    0.0000   0.0000    0.0000  0.0000  1047.3291  1.0038
        p[1]    0.0002   0.0001    0.0000  0.0000  1471.1339  1.0024
        p[2]    0.0007   0.0000    0.0000  0.0000  2746.0310  0.9997
        sigC  321.1844  41.1352    0.6504  1.1266  1586.5783  1.0008
        sigD    4.9647   0.5299    0.0084  0.0116  2646.0062  1.0007
       sigRc  589.2263  55.8802    0.8835  0.8144  3247.0897  1.0001
        β[1]    1.7364   0.3556    0.0056  0.0085  1625.8561  1.0012
        β[2]    0.9517   0.6832    0.0108  0.0092  4596.2642  0.9997
        γ[1]    0.8178   0.2412    0.0038  0.0060  1431.9766  1.0022
        γ[2]    0.0181   0.0011    0.0000  0.0000  2299.7501  1.0004
           τ    0.0000   0.0000    0.0000  0.0000  3772.0254  1.0001

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
  ──────────  ────────  ────────  ────────  ────────  ────────
           a    0.4126    0.6183    0.7560    0.8861    0.9893
         pE0    0.0000    0.0000    0.0000    0.0000    0.0000
        p[1]    0.0001    0.0001    0.0002    0.0002    0.0003
        p[2]    0.0007    0.0007    0.0007    0.0007    0.0008
        sigC  255.3503  292.9805  315.9003  343.8002  414.9159
        sigD    3.9841    4.6058    4.9401    5.2969    6.1085
       sigRc  493.2846  550.6845  584.6365  621.8216  714.2856
        β[1]    1.1571    1.4793    1.6956    1.9456    2.5213
        β[2]    0.0481    0.4002    0.8243    1.3799    2.5147
        γ[1]    0.4246    0.6434    0.7912    0.9683    1.3553
        γ[2]    0.0158    0.0173    0.0181    0.0188    0.0203
           τ    0.0000    0.0000    0.0000    0.0000    0.0000
</code></pre>
<h2 id="fit">Fit<a class="headerlink" href="#fit" title="Permanent link">&para;</a></h2>
<pre><code class="julia">sdf = simtrajectories(cc, korea, 1:150)
f = plotvars(sdf, korea)
plot!(f.fit, xlim=nothing)
</code></pre>

<p><img alt="" src="../figures/korea_7_1.png" /></p>
<p>We see that the model does not fit the rapid drop in new cases in South
Korea. This may be caused by the model’s implausible assumption that
transmission and testing rates are constant over time.</p>
<h2 id="implications">Implications<a class="headerlink" href="#implications" title="Permanent link">&para;</a></h2>
<pre><code class="julia">for fig in f.trajectories
  display(plot(fig, xlim=nothing))
end
</code></pre>

<p><img alt="" src="../figures/korea_8_1.png" /> <img alt="" src="../figures/korea_8_2.png" />
<img alt="" src="../figures/korea_8_3.png" /> <img alt="" src="../figures/korea_8_4.png" />
<img alt="" src="../figures/korea_8_5.png" /> <img alt="" src="../figures/korea_8_6.png" />
<img alt="" src="../figures/korea_8_7.png" /> <img alt="" src="../figures/korea_8_8.png" />
<img alt="" src="../figures/korea_8_9.png" /> <img alt="" src="../figures/korea_8_10.png" />
<img alt="" src="../figures/korea_8_11.png" /> <img alt="" src="../figures/korea_8_12.png" />
<img alt="" src="../figures/korea_8_13.png" /> <img alt="" src="../figures/korea_8_14.png" /></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Paul Schrimpf</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
        <script src="../assets/mathjaxhelper.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
