<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Paul Schrimpf">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>South Korea - CovidSEIR.jl</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-forest-light.min.css">
        <link href="../assets/Documenter.css" rel="stylesheet">
        <link href="../assets/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">CovidSEIR.jl</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Package Docs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">SEIR Model and Results <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../covid/" class="dropdown-item">Model</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Results</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../canada/" class="dropdown-item">Canada</a>
</li>
            
<li>
    <a href="../italy/" class="dropdown-item">Italy</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">South Korea</a>
</li>
            
<li>
    <a href="../china/" class="dropdown-item">China</a>
</li>
            
<li>
    <a href="../us/" class="dropdown-item">United States</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../italy/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../china/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/schrimpf/CovidSEIR.jl/edit/master/docs/korea.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#south-korea" class="nav-link">South Korea</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#estimates" class="nav-link">Estimates</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fit" class="nav-link">Fit</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#implications" class="nav-link">Implications</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></p>
<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike
4.0 International
License</a></p>
<pre><code class="julia">using CovidSEIR,  Plots, DataFrames, JLD2, StatsPlots
Plots.pyplot()
jmddir = normpath(joinpath(dirname(Base.find_package(&quot;CovidSEIR&quot;)),&quot;..&quot;,&quot;docs&quot;,&quot;jmd&quot;))
covdf = covidjhudata();
</code></pre>

<h1 id="south-korea">South Korea<a class="headerlink" href="#south-korea" title="Permanent link">&para;</a></h1>
<pre><code class="julia">korea = CountryData(covdf, &quot;Korea, South&quot;)
</code></pre>

<pre><code>CountryData{Float64,Int64}(5.1635256e7, [1, 2, 3, 4, 5, 6, 7, 8, 9, 10  …  
64, 65, 66, 67, 68, 69, 70, 71, 72, 73], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
, 0.0, 0.0, 0.0  …  126.0, 131.0, 139.0, 144.0, 152.0, 158.0, 162.0, 165.0,
 169.0, 174.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  3730.
0, 4144.0, 4528.0, 4811.0, 5033.0, 5228.0, 5408.0, 5567.0, 5828.0, 6021.0],
 [1.0, 1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 11.0  …  5281.0, 4966.0, 466
5.0, 4523.0, 4398.0, 4275.0, 4216.0, 4155.0, 3979.0, 3867.0])
</code></pre>
<pre><code class="julia">using Turing
mdl = CovidSEIR.TimeVarying.countrymodel(korea)
cc = Turing.psample(mdl, NUTS(0.65), 5000, 4)
import JLD2
JLD2.@save &quot;$jmddir/korea_tv_$(Dates.today()).jld2&quot; cc
</code></pre>

<pre><code class="julia">JLD2.@load &quot;$jmddir/korea_tv_2020-04-03.jld2&quot; cc dayt0;
</code></pre>

<h2 id="estimates">Estimates<a class="headerlink" href="#estimates" title="Permanent link">&para;</a></h2>
<pre><code class="julia">plot(cc)
</code></pre>

<p><img alt="" src="../figures/korea_5_1.png" /></p>
<pre><code class="julia">describe(cc)
</code></pre>

<pre><code>2-element Array{ChainDataFrame,1}

Summary Statistics
  parameters      mean       std  naive_se    mcse       ess   r_hat
  ──────────  ────────  ────────  ────────  ──────  ────────  ──────
           a    0.3318    0.1198    0.0009  0.0055  202.5444  1.0440
         pE0    0.0000    0.0000    0.0000  0.0000  127.1879  1.0589
        p[1]    0.0406    0.0278    0.0002  0.0020   64.2570  1.8436
        p[2]    0.1086    0.1981    0.0016  0.0138   64.2570  1.6839
        sigC  263.1219   61.4888    0.4861  4.3856   64.2570  1.7283
        sigD    7.3173    1.4366    0.0114  0.0928   64.2570  1.4225
       sigRc  635.9013  103.0874    0.8150  6.7176   64.2570  1.4837
        β[1]    0.3423    0.1827    0.0014  0.0112   70.1779  1.3082
        β[2]    0.0660    0.1728    0.0014  0.0090   86.6956  1.2103
        β[3]    0.5721    0.4471    0.0035  0.0193  203.7240  1.0716
        γ[1]    0.0070    0.0096    0.0001  0.0008   64.2570  2.6411
        γ[2]    0.1350    0.1560    0.0012  0.0100   65.7633  1.3472
        ρ[1]    0.9966    0.0089    0.0001  0.0003  554.6391  1.0362
        ρ[2]   39.5956    0.9166    0.0072  0.0482   98.0607  1.1285
           τ    0.8106    0.8588    0.0068  0.0374  391.5204  1.0285

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
  ──────────  ────────  ────────  ────────  ────────  ────────
           a    0.2026    0.2501    0.2998    0.3734    0.6811
         pE0    0.0000    0.0000    0.0000    0.0000    0.0000
        p[1]    0.0008    0.0027    0.0483    0.0599    0.0842
        p[2]    0.0014    0.0019    0.0024    0.1507    0.6727
        sigC  188.9998  218.0311  239.0684  309.5063  401.1423
        sigD    4.9916    6.1158    7.3347    8.3122   10.2576
       sigRc  476.9011  559.0011  614.9013  710.2584  855.0331
        β[1]    0.0153    0.2023    0.3449    0.4805    0.6640
        β[2]    0.0000    0.0003    0.0010    0.0243    0.6046
        β[3]    0.0313    0.2425    0.4611    0.8003    1.6856
        γ[1]    0.0000    0.0003    0.0009    0.0203    0.0237
        γ[2]    0.0383    0.0546    0.0680    0.1152    0.6220
        ρ[1]    0.9813    0.9968    0.9986    0.9995    0.9999
        ρ[2]   37.8331   38.9631   39.5679   40.1664   41.5414
           τ    0.2153    0.3125    0.4618    0.8724    3.4682
</code></pre>
<h2 id="fit">Fit<a class="headerlink" href="#fit" title="Permanent link">&para;</a></h2>
<pre><code class="julia">sdf = simtrajectories(cc, korea, 1:150)
f = plotvars(sdf, korea, dayt0=dayt0)
plot!(f.fit, xlim=nothing)
</code></pre>

<p><img alt="" src="../figures/korea_7_1.png" /></p>
<p>We see that the model does not fit the rapid drop in new cases in South
Korea. This may be caused by the model’s implausible assumption that
transmission and testing rates are constant over time.</p>
<h2 id="implications">Implications<a class="headerlink" href="#implications" title="Permanent link">&para;</a></h2>
<pre><code class="julia">for fig in f.trajectories
  display(plot(fig, xlim=nothing))
end
</code></pre>

<p><img alt="" src="../figures/korea_8_1.png" /> <img alt="" src="../figures/korea_8_2.png" />
<img alt="" src="../figures/korea_8_3.png" /> <img alt="" src="../figures/korea_8_4.png" />
<img alt="" src="../figures/korea_8_5.png" /> <img alt="" src="../figures/korea_8_6.png" />
<img alt="" src="../figures/korea_8_7.png" /> <img alt="" src="../figures/korea_8_8.png" />
<img alt="" src="../figures/korea_8_9.png" /> <img alt="" src="../figures/korea_8_10.png" />
<img alt="" src="../figures/korea_8_11.png" /> <img alt="" src="../figures/korea_8_12.png" />
<img alt="" src="../figures/korea_8_13.png" /> <img alt="" src="../figures/korea_8_14.png" /></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Paul Schrimpf</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
        <script src="../assets/mathjaxhelper.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
