<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Paul Schrimpf">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>South Korea - CovidSEIR.jl</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-forest-light.min.css">
        <link href="../assets/Documenter.css" rel="stylesheet">
        <link href="../assets/extra.css" rel="stylesheet">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">CovidSEIR.jl</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Package Docs</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">SEIR Model and Results <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../covid/" class="dropdown-item">Model</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Results</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../canada/" class="dropdown-item">Canada</a>
</li>
            
<li>
    <a href="../italy/" class="dropdown-item">Italy</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">South Korea</a>
</li>
            
<li>
    <a href="../china/" class="dropdown-item">China</a>
</li>
            
<li>
    <a href="../us/" class="dropdown-item">United States</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../license/" class="dropdown-item">License</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../italy/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../china/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/schrimpf/CovidSEIR.jl/edit/master/docs/korea.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#south-korea" class="nav-link">South Korea</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#estimates" class="nav-link">Estimates</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fit" class="nav-link">Fit</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#implications" class="nav-link">Implications</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></p>
<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike
4.0 International
License</a></p>
<pre><code class="julia">using CovidSEIR,  Plots, DataFrames, JLD2, StatsPlots
Plots.pyplot()
jmddir = normpath(joinpath(dirname(Base.find_package(&quot;CovidSEIR&quot;)),&quot;..&quot;,&quot;docs&quot;,&quot;jmd&quot;))
covdf = covidjhudata();
</code></pre>

<h1 id="south-korea">South Korea<a class="headerlink" href="#south-korea" title="Permanent link">&para;</a></h1>
<pre><code class="julia">korea = CountryData(covdf, &quot;Korea, South&quot;)
</code></pre>

<pre><code>CovidSEIR.CountryData{Float64,Int64}(5.1635256e7, [1, 2, 3, 4, 5, 6, 7, 8, 
9, 10  …  69, 70, 71, 72, 73, 74, 75, 76, 77, 78], [0.0, 0.0, 0.0, 0.0, 0.0
, 0.0, 0.0, 0.0, 0.0, 0.0  …  158.0, 162.0, 165.0, 169.0, 174.0, 177.0, 183
.0, 186.0, 192.0, 200.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
  …  5228.0, 5408.0, 5567.0, 5828.0, 6021.0, 6325.0, 6463.0, 6598.0, 6694.0
, 6776.0], [1.0, 1.0, 2.0, 2.0, 3.0, 4.0, 4.0, 4.0, 4.0, 11.0  …  4275.0, 4
216.0, 4155.0, 3979.0, 3867.0, 3654.0, 3591.0, 3500.0, 3445.0, 3408.0])
</code></pre>
<pre><code class="julia">using Turing
mdl = CovidSEIR.TimeVarying.countrymodel(korea)
cc = Turing.psample(mdl, NUTS(0.65), 5000, 4)
import JLD2
JLD2.@save &quot;$jmddir/korea_tv_$(Dates.today()).jld2&quot; cc
</code></pre>

<pre><code class="julia">JLD2.@load &quot;$jmddir/korea_tv_2020-04-09.jld2&quot; cc dayt0;
</code></pre>

<h2 id="estimates">Estimates<a class="headerlink" href="#estimates" title="Permanent link">&para;</a></h2>
<pre><code class="julia">plot(cc)
</code></pre>

<p><img alt="" src="../figures/korea_5_1.png" /></p>
<pre><code class="julia">describe(cc)
</code></pre>

<pre><code>2-element Array{MCMCChains.ChainDataFrame,1}

Summary Statistics
  parameters      mean       std  naive_se    mcse       ess   r_hat
  ──────────  ────────  ────────  ────────  ──────  ────────  ──────
           a    0.4954    0.2203    0.0017  0.0145   64.2570  1.4955
         pE0    0.0000    0.0000    0.0000  0.0000   73.7984  1.2059
        p[1]    0.0382    0.0617    0.0005  0.0043   78.2802  1.1632
        p[2]    0.0014    0.0007    0.0000  0.0000   64.2570  2.3943
        sigC  249.4830   44.4736    0.3516  2.9762   64.2570  1.7494
        sigD    7.0278    0.7375    0.0058  0.0298  173.4050  1.0978
       sigRc  756.7289  140.4338    1.1102  9.8428   64.2570  2.0736
        β[1]    0.6179    0.5052    0.0040  0.0293   71.5561  1.3055
        β[2]    0.3807    0.6122    0.0048  0.0350   64.2570  1.3982
        β[3]    0.7337    0.4987    0.0039  0.0239  116.3282  1.1583
        γ[1]    0.4345    0.4815    0.0038  0.0352   64.2570  2.4452
        γ[2]    0.0444    0.0200    0.0002  0.0015   64.2570  2.3413
        ρ[1]    0.8318    0.2492    0.0020  0.0153   64.2570  1.4107
        ρ[2]   45.3747    9.7411    0.0770  0.6197   64.2570  1.4373
           τ    0.1899    0.3263    0.0026  0.0180   87.2755  1.2937

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%      97.5%
  ──────────  ────────  ────────  ────────  ────────  ─────────
           a    0.2171    0.3038    0.4594    0.6567     0.9638
         pE0    0.0000    0.0000    0.0000    0.0000     0.0000
        p[1]    0.0001    0.0002    0.0432    0.0555     0.1144
        p[2]    0.0008    0.0008    0.0010    0.0019     0.0028
        sigC  182.4047  215.6029  241.2664  280.4259   346.7645
        sigD    5.8430    6.5446    6.9404    7.4058     8.8146
       sigRc  546.4491  637.6855  747.7038  869.6567  1031.7307
        β[1]    0.0407    0.2552    0.4668    0.8947     1.8625
        β[2]    0.0000    0.0005    0.0018    0.6110     2.0656
        β[3]    0.0331    0.3567    0.6810    1.0008     1.9239
        γ[1]    0.0000    0.0005    0.0336    0.8458     1.4127
        γ[2]    0.0247    0.0266    0.0345    0.0605     0.0870
        ρ[1]    0.1381    0.7267    0.9911    0.9983     0.9999
        ρ[2]   37.8295   38.9232   39.8948   51.4316    67.8713
           τ    0.0000    0.0000    0.0939    0.2897     0.7369
</code></pre>
<h2 id="fit">Fit<a class="headerlink" href="#fit" title="Permanent link">&para;</a></h2>
<pre><code class="julia">sdf = simtrajectories(cc, korea, 1:150)
f = plotvars(sdf, korea, dayt0=dayt0)
plot!(f.fit, xlim=nothing)
</code></pre>

<p><img alt="" src="../figures/korea_7_1.png" /></p>
<p>We see that the model does not fit the rapid drop in new cases in South
Korea. This may be caused by the model’s implausible assumption that
transmission and testing rates are constant over time.</p>
<h2 id="implications">Implications<a class="headerlink" href="#implications" title="Permanent link">&para;</a></h2>
<pre><code class="julia">for fig in f.trajectories
  display(plot(fig, xlim=nothing))
end
</code></pre>

<p><img alt="" src="../figures/korea_8_1.png" /> <img alt="" src="../figures/korea_8_2.png" />
<img alt="" src="../figures/korea_8_3.png" /> <img alt="" src="../figures/korea_8_4.png" />
<img alt="" src="../figures/korea_8_5.png" /> <img alt="" src="../figures/korea_8_6.png" />
<img alt="" src="../figures/korea_8_7.png" /> <img alt="" src="../figures/korea_8_8.png" />
<img alt="" src="../figures/korea_8_9.png" /> <img alt="" src="../figures/korea_8_10.png" />
<img alt="" src="../figures/korea_8_11.png" /> <img alt="" src="../figures/korea_8_12.png" />
<img alt="" src="../figures/korea_8_13.png" /> <img alt="" src="../figures/korea_8_14.png" /></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Paul Schrimpf</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML" defer></script>
        <script src="../assets/mathjaxhelper.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
